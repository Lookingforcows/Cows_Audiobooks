<script>
    $(document).ready(function() {
        var rssFeedUrl = "https://anchor.fm/s/e586064c/podcast/rss";

        // Fetch the RSS feed
        $.ajax({
            url: rssFeedUrl,
            dataType: "xml",
            success: function(xml) {
                // Parse the XML data and append podcast episodes
                $(xml).find("item").each(function(index) {
                    var title = $(this).find("title").text();
                    var description = $(this).find("description").text();
                    var artworkUrl = $(this).find("itunes\\:image").attr("href");
                    var audioUrl = $(this).find("enclosure").attr("url"); // Assuming the audio file URL is in the "enclosure" tag

                    // Create HTML content for each podcast episode
                    var episodeHtml = 
                        `<div class="podcast-episode">
                            <h2 class="podcast-title">${title}</h2>
                            <img src="${artworkUrl}" alt="Podcast Artwork" class="podcast-artwork">
                            <p class="podcast-description">${description}</p>
                            <audio controls class="audio-player" style="width: 100%;">
                                <source src="${audioUrl}" type="audio/mpeg">
                            </audio>
                            <button class="stop-button" style="display: none;">Stop</button>
                            <div class="progress-bar-container" style="display: none;">
                                <progress class="progress-bar" value="0" max="100"></progress>
                            </div>
                        </div>`;

                    // Append the HTML content to the podcast container
                    $("#podcast-container").append(episodeHtml);
                });

                // Add event listeners after all episodes have been appended
                $(".podcast-episode").each(function(index) {
                    var episode = $(this);
                    var audioPlayer = episode.find('.audio-player');
                    var stopButton = episode.find('.stop-button');
                    var progressBarContainer = episode.find('.progress-bar-container');

                    stopButton.click(function() {
                        audioPlayer[0].pause(); // Pause the audio
                        audioPlayer[0].currentTime = 0; // Reset audio playback to the beginning
                        stopButton.hide();
                        progressBarContainer.hide();
                    });

                    // Update progress bars as audio plays
                    audioPlayer.on("timeupdate", function() {
                        var currentTime = this.currentTime;
                        var duration = this.duration;
                        var progress = (currentTime / duration) * 100;

                        episode.find('.progress-bar').val(progress);
                    });
                });
            },
            error: function(xhr, status, error) {
                console.error(xhr, status, error); // Log any errors to the console for debugging
            }
        });
    });
</script>
